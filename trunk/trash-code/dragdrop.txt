        private void panel3_listBox_MouseDown(object sender, MouseEventArgs e)
        {
            if(((ListBox)sender).Items.Count==0) 
                return;

            int index = ((ListBox)sender).IndexFromPoint(e.X, e.Y);
            string s = ((ListBox)sender).Items[index].ToString(); 
            DragDropEffects dde1 = DoDragDrop(s,DragDropEffects.Move);

            if (dde1 == DragDropEffects.Move)
            {
                if (s == ((ListBox)sender).Items[index].ToString())
                    ((ListBox)sender).Items.RemoveAt(index);
                else
                    ((ListBox)sender).Items.RemoveAt(index + 1); 
            } 
        }

        private void panel3_listBox_DragEnter(object sender, DragEventArgs e)
        {
            if (e.Data.GetDataPresent(DataFormats.Text))
                e.Effect = DragDropEffects.Move;
            else
                e.Effect = DragDropEffects.None; 
        }

        private void panel3_listBox_DragDrop(object sender, DragEventArgs e)
        {
            if (e.Data.GetDataPresent(DataFormats.StringFormat))
            {
                string str = (string)e.Data.GetData(DataFormats.StringFormat);
                int indexPos = ((ListBox)sender).IndexFromPoint(((ListBox)sender).PointToClient(new Point(e.X, e.Y))); 
                string path;
                
                if (indexPos > -1)
                {
                    ((ListBox)sender).Items.Insert(indexPos, str);

                    path = filenames[0].Substring(0, filenames[0].LastIndexOf(System.IO.Path.DirectorySeparatorChar) +1 );

                    for(int i =0; i < ((ListBox)sender).Items.Count; i++)
                    {
                        filenames[i] = path + ((ListBox)sender).Items[i].ToString();
                    }

                }
                else
                {
                    ((ListBox)sender).Items.Add(str);

                    path = filenames[0].Substring(0, filenames[0].LastIndexOf(System.IO.Path.DirectorySeparatorChar) + 1);

                    for (int i = 0; i < ((ListBox)sender).Items.Count; i++)
                    {
                        filenames[i] = path + ((ListBox)sender).Items[i].ToString();
                    }
                }
            } 
        }
